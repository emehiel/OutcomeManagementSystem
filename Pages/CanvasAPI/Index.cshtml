@page "{id:int?}"
@model OutcomeManagementSystem.Pages.CanvasAPI.IndexModel
@{
    ViewData["Title"] = "Canvas-Test";
}

<a asp-page="./Index" asp-route-id="@Model.AccOutcome[0].id" type="button" class="btn btn-primary">@Model.AccOutcome[0].title</a>

@{ if (Model.SubOutcomeGrp != null)
    {
        foreach (var outcomeGrp in Model.SubOutcomeGrp)
        {

            <div class="card">
                <div class="card-body">
                    <a asp-page="./Index" asp-route-id="@outcomeGrp.id" type="button" class="btn btn-primary">@outcomeGrp.title + </a>
                    @* <a type="button" href="#" class="btn btn-primary" onclick="myFunc();">Outcomes</a>*@

                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#@outcomeGrp.title.Replace(" ","")" runat="server">
                        Outcomes
                    </button>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newoutcome" runat="server">
                        New Outcome
                    </button>
                </div>
            </div>

            <div class="modal fade" id="@outcomeGrp.title.Replace(" ","")" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Outcomes</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            @{
                                var subgs = Model.subgroup.GetSubGroupOutcomes(outcomeGrp.id);
                                if (subgs.Count != 0)
                                {
                                    foreach (var OutItem in subgs)
                                    {
                                        <div class="card">
                                                                        <div class="card-body">
                                                                            <p>@OutItem.outcome.title</p>
                                                                            
                                                                                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#@OutItem.outcome.title.Replace(" ","")" runat="server">
                                                                                    Update Outcome
                                                                                </button>

                                                                                <form method="post">
                                                                                    <input asp-for="Delete.ID" value="@OutItem.outcome.id" class="form-control" type="text" hidden="hidden" placeholder="" aria-label="default input example">
                                                                                    <input asp-for="Delete.GrpID" value="@outcomeGrp.id" class="form-control" type="text" hidden="hidden" placeholder="" aria-label="default input example">
                                                                                    <input type="submit" value="Delete" class="btn btn-primary" />
                                                                                </form>
                                                                            
                                                                        </div>
                                        </div>
                                        <form method="post">
                                            <div class="modal fade" id="@OutItem.outcome.title.Replace(" ","")" tabindex="-1">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="exampleModalLabel">Update Outcome</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <input asp-for="Mod.InputID" value="@OutItem.outcome.id" class="form-control" type="text" hidden="hidden" placeholder="Title" aria-label="default input example">
                                                            <input asp-for="Mod.Title" value="@OutItem.outcome.title" class="form-control" type="text" placeholder="Title" aria-label="default input example">
                                                            <input asp-for="Mod.DisplayName" value="@OutItem.outcome.display_name" class="form-control" type="text" placeholder="Display Name" aria-label="default input example">
                                                            @*<input asp-for="Mod.Description" value="@OutItem.outcome.description" class="form-control" type="text" placeholder="Description" aria-label="default input example">
        <input asp-for="Mod.CalcType" value="@OutItem.outcome.calculation_method" list="datalistOptions" class="form-control" placeholder="Calcuation Method" aria-label="default input example">
        <datalist id="datalistOptions">
            <option value="decaying_average" />
            <option value="n_mastery" />
            <option value="latest" />
            <option value="highest" /> $('.modal-content').width()
        </datalist>*@
                                                        </div>
                                                        <div class="modal-footer">
                                                            <input type="submit" value="Save" class="btn btn-primary" />
                                                            @*<button type="button" class="btn btn-primary">Save changes</button>*@
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>


                                        <script type="text/javascript">
                                            $('#@OutItem.outcome.title.Replace(" ","")').css("margin-left", $(window).width() - $('.modal-content').width());
                                        </script>


                                    }
                                }
                                else
                                {
                                    <p>There are no outcomes for this group</p>
                                }

                            }
                        </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                                @*<button type="button" class="btn btn-primary">Save changes</button>*@
                                            </div>
                                        </div>
                                    </div>
            </div>


            <form method="post">
            <div class="modal fade" id="newoutcome" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">New Outcome</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <input asp-for="Input.InputID" class="form-control" type="text" hidden="hidden" placeholder="Title" value="@outcomeGrp.id" aria-label="default input example">
                            <input asp-for="Input.Title" class="form-control" type="text" placeholder="Title" aria-label="default input example">
                            <input asp-for="Input.DisplayName" class="form-control" type="text" placeholder="Display Name" aria-label="default input example">
                            <input asp-for="Input.Description" class="form-control" type="text" placeholder="Description" aria-label="default input example">
                            <input asp-for="Input.CalcType"  list="datalistOptions" class="form-control" placeholder="Calcuation Method" aria-label="default input example">
                            <datalist id="datalistOptions">
                                <option value="decaying_average" />
                                <option value="n_mastery" />
                                <option value="latest" />
                                <option value="highest" />
                            </datalist>
                        </div>
                        <div class="modal-footer">
                            <input type="submit" value="Create" class="btn btn-primary" />
                            @*<button type="button" class="btn btn-primary">Save changes</button>*@
                        </div>
                    </div>
                </div>
            </div>
                </form>
        }

    }
}


@*keeping the below code because it might be useful someday*@

<!--<script type="text/javascript">
                  //document.getElementById().addEventListener("click", myFunction);
        function myFunc(id) {

            doModal('test','test');
        }

        function doModal(test) {
        html = '<div id="dynamicModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="confirm-modal" aria-hidden="true">';
        html += '<div class="modal-dialog">';
        html += '<div class="modal-content">';
        html += '<div class="modal-header">';
        html += '<h5 class="modal-title" id="exampleModalLabel">Outcomes</h5>';
        html += '<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>';
        html += '</div>';
          html += '<div class="modal-body">';-->
@*//html += '<p>' + @Model.Outcomes[0].outcome.title +'</p>';*@
<!--<!--<!--html += '<p>'+'test</p>';
        html += '</div>';
        html += '<div class="modal-footer">';
        html += '<span class="btn btn-primary" data-dismiss="modal">Close</span>';
        html += '</div>';  // content
        html += '</div>';  // dialog
        html += '</div>';  // footer
        html += '</div>';  // modalWindow
        $('body').append(html);
        $("#dynamicModal").modal();
        $("#dynamicModal").modal('show');

        $('#dynamicModal').on('hidden.bs.modal', function (e) {
            $(this).remove();
        });
    }
</script>-->
